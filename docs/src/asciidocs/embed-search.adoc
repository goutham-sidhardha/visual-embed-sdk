= Embed ThoughtSpot search
:toc: true
:toclevels: 1

:page-title: Embed Search
:page-pageid: search-embed
:page-description: You can use the SearchEmbed SDK library to embed ThoughtSpot search and use it for live queries.

This article provides step-by-step instructions to embed ThoughtSpot search function in your app. The embedded search API allows your application users to search for data from one or several data sources.

[IMPORTANT]
====
The Search Embed feature is in Beta in ThoughtSpot Software 7.1.1 and 7.2.1 versions. For an optimal user experience, we recommend that you use the Full application embed (`appEmbed`) package and set *Search* as the active tab on your embedded instance.
====

== Import the SearchEmbed package

Import the SearchEmbed SDK library to your application environment:

**npm**
[source,javascript]
----
import {
    SearchEmbed,
    AuthType,
    init,
    prefetch,
    EmbedEvent
}
from '@thoughtspot/visual-embed-sdk';
----

**ES6**
[source,javascript]
----
<script type = 'module'>
    import {
        SearchEmbed,
        AuthType,
        init,
        prefetch,
        EmbedEvent
    }
from 'https://cdn.jsdelivr.net/npm/@thoughtspot/visual-embed-sdk/dist/tsembed.es.js';
----

== Initialize the SDK

Specify the hostname or IP address of your ThoughtSpot application instance and the authentication type.

[source,javascript]
----
init({
    thoughtSpotHost: "https://<hostname>:<port>",
    authType: AuthType.SSO,
});
----
thoughtSpotHost::
_String_. Hostname or IP address of the ThoughtSpot application.

include::{path}/embed-auth-config.adoc[]

== Prefetch static resources (Optional)

To prefetch static resources and load your application fast, set the `callPrefetch` attribute to `true`.

For more information, see xref:prefetch-and-cache.adoc[Prefetch static resources].

== Configure security and login parameters (Optional)

include::{path}/embed-config.adoc[]

== Create an instance of the SearchEmbed class

Create an instance of the SearchEmbed object and customize your search page view.

[source,javascript]

----
const searchEmbed = new SearchEmbed(document.getElementById('ts-embed'), {
    frameParams: {
        width: '100%',
        height: '100%',
    },
    answerId: "<%=savedAnswerGUID%>",
    dataSources: ['<%=datasourceGUID%>'],
    collapseDataSources: false,
    disabledActions: [],
    disabledActionReason: '<reason for disabling>',
    forceTable: false,
    hiddenActions: [],
    hideDataSources: false,
    hideResults: false,
    searchOptions: {
        searchTokenString: '<TML-query-string>',
        executeSearch: true,
    },
});
----
frameParams::
Sets the `width` and `height` dimensions to render the search object in a web browser. You can set the `width` and `height` attribute values in pixels or as a percentage.

answerID __Optional__::
_String_. The Global Unique Identifiers (GUID) of the answers saved in a user profile.

dataSources::
_Array of strings_. The GUIDs of the data sources for running a search query on.

collapseDataSources __Optional__::
_Boolean_. When set to true, it minimizes the Data Source panel.

+
++++
<a href="{{previewPrefix}}/playground/search?collapseDataSources=true" id="preview-in-playground" target="_blank">Try it out</a>
++++


disabledActions __Optional__::
_Array of strings_. Disables the specified menu items from the list of actions on a search results page. You can use this attribute to restrict user access to certain features.
+
For example, to disable the *Show underlying data* action from the *More* menu image:./images/icon-more-10px.png[the more options menu], specify the `ShowUnderlyingData` action menu string in the `disabledActions` attribute.

+

----
disabledActions: Action.ShowUnderlyingData
----
+
++++
<a href="{{previewPrefix}}/playground/search?modifyActions=true" id="preview-in-playground" target="_blank">Try it out</a>
++++

disabledActionReason __Optional__::
_String_. Indicates the reason for disabling an action on search data.


hiddenActions __Optional__::
_Array of strings_. Hides the specified actions on the search result page. You can use this attribute to remove actions that are not relevant to your application context.

+
++++
<a href="{{previewPrefix}}/playground/search?modifyActions=true" id="preview-in-playground" target="_blank">Try it out</a>
++++

+
For example, to hide the *Share* action from the *More* menu image:./images/icon-more-10px.png[the more options menu], specify the `Share` action menu string in the `hiddenActions` attribute.

+
----
hiddenActions: ['Action.Share']
----
+
For a complete list of action menu items and the corresponding strings to use for disabling or hiding menu items, see xref:embed-actions.adoc[Disable or hide UI actions].

[NOTE]
====
ThoughtSpot automatically creates a modifiable action ID based on the name you assign to a custom action. For example, if you set the name of a custom action as `Send Email`, ThoughtSpot sets the ID for this action as `send-email` by default. To disable, hide, or show a custom action in the embedded UI, you must specify the ID of the custom action as the action string in the `disabledActions` and `hiddenActions` attributes.
====

hideDataSources __Optional__::
_Boolean_. When set to true, it hides the default Data Source panel. Use this attribute if you want to create a custom data panel.

+
++++
<a href="{{previewPrefix}}/playground/search?hideDataSources=true" id="preview-in-playground" target="_blank">Try it out</a>
++++

forceTable __Optional__:::
_Boolean_. When set to `true`, the tabular view is set as the default format for presenting search data.

+
++++
<a href="{{previewPrefix}}/playground/search" id="preview-in-playground" target="_blank">Try it out</a>
++++

hideResults __Optional__::
_Boolean_. When set to true, it hides charts and tables that appear beneath the search bar. You can use this attribute to hide charts and tables when creating custom visualizations using raw data from a saved answer.

+
++++
<a href="{{previewPrefix}}/playground/search?hideResults=true" id="preview-in-playground" target="_blank">Try it out</a>
++++

////
enableSearchAssist [small]_optional_::
_Boolean_. When set to true, it enables Search Assist. Search Assist allows you to create a custom onboarding experience for your users by demonstrating how to search data from the example queries created on your worksheet.


+
++++
<a href="{{previewPrefix}}/playground/search?enableSearchAssist=true" id="preview-in-playground" target="_blank">Preview in Playground</a>
++++

////


[#search-query]
searchOptions [small]#__Optional__#::
Allows you to specifiy a search token string and execute search.

* `searchTokenString`
+
__String__. The ThoughtSpot Modeling Language (TML) query string. For example, to use the `product` and `sales` keywords, you can set the search token as shown here:

+

    searchTokenString: '[sales][product name]'

* `executeSearch`
__Boolean__. When set to `true`, the  focus is placed on search results. When set to `false`, the focus is placed at the end of search tokens in the search bar.
+

[source, javascript]
----
searchOptions: {
    searchTokenString: '[product][sales][date].daily',
    executeSearch: true,
}
----


++++
<a href="{{previewPrefix}}/playground/search/searchOptions=true" id="preview-in-playground" target="_blank">Try it out</a>
++++

== Define a method to process callback custom action payloads

include::{path}/callback-payload.adoc[]

== Subscribe to events

Register event handlers to subscribe to embed events triggered by the ThoughtSpot Search function.

[source, javascript]
----
searchEmbed.on(EmbedEvent.Init, showLoader)
searchEmbed.on(EmbedEvent.Load, hideLoader)
----

For more information, see xref:embed-events.adoc[Event subscription and handling].

== Render the embedded search

[source, javascript]
----
 searchEmbed.render();
----

== Test the embedded workflow


* Load your application.
* Perform a search operation and verify the results.
* Verify if the page view parameters, such as hiding or showing the data source panel, function as expected.
* Verify if the actions are displayed or hidden as configured in the SDK.


== Additional resources

* For code examples, see xref:code-samples.adoc[Code samples].
* For more information about the SDK APIs and attributes, see xref:sdk-reference.adoc[Visual Embed SDK Reference].
